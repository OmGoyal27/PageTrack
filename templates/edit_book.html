{% extends 'base.html' %}
{% block content %}
<h2>Edit Book</h2>
<form method="post" class="row g-3" id="book-form">
    <div class="col-md-4">
        <label for="isbn" class="form-label">ISBN</label>
        <div class="input-group">
            <input type="text" class="form-control" id="isbn" name="isbn" value="{{ book.isbn }}">
            <button class="btn btn-outline-secondary" type="button" id="fetch-btn">Fetch</button>
        </div>
    </div>
</form>
<script>
document.getElementById('fetch-btn').onclick = function() {
        const isbn = document.getElementById('isbn').value.trim();
        if (!isbn) return;
        fetch(`/api/fetch_book_info?isbn=${isbn}`)
            .then(r => r.json())
            .then(data => {
                if (data.error) { alert(data.error); return; }
                document.getElementById('title').value = data.title || '';
                document.getElementById('author').value = data.author || '';
                document.getElementById('year').value = data.year || '';
                document.getElementById('description').value = data.description || '';
            });
};
</script>
    <div class="col-md-6">
        <label for="title" class="form-label">Title</label>
        <input type="text" class="form-control" id="title" name="title" value="{{ book.title }}" required>
    </div>
    <div class="col-md-6">
        <label for="author" class="form-label">Author</label>
        <input type="text" class="form-control" id="author" name="author" value="{{ book.author }}" required>
    </div>
    <div class="col-md-4">
        <label for="year" class="form-label">Year</label>
        <input type="text" class="form-control" id="year" name="year" value="{{ book.year }}">
    </div>
    <div class="col-12">
        <label for="description" class="form-label">Description</label>
        <textarea class="form-control" id="description" name="description" rows="3">{{ book.description }}</textarea>
    </div>
    <div class="col-12">
        <button type="submit" class="btn btn-primary">Save Changes</button>
        <a href="/" class="btn btn-secondary">Cancel</a>
    </div>
</form>
{% endblock %}
